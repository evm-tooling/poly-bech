declare suite bubbleN performance timeBased sameDataset: true {
    description: "O(n^2) bubble sort on int32 array"
    warmup: 100
    targetTime: 100ms
    fairness: "strict"
    cvThreshold: 5
    count: 1

    setup go {
        import (
            "encoding/binary"
        )

        helpers {
            func bubbleGo(data []byte) []byte {
                n := len(data) / 4
                arr := make([]int32, n)
                for i := 0; i < n; i++ {
                    arr[i] = int32(binary.BigEndian.Uint32(data[i*4 : (i+1)*4]))
                }
                for i := 0; i < n; i++ {
                    for j := 0; j < n-1-i; j++ {
                        if arr[j] > arr[j+1] {
                            tmp := arr[j]
                            arr[j] = arr[j+1]
                            arr[j+1] = tmp
                        }
                    }
                }
                out := make([]byte, len(data))
                for i := 0; i < n; i++ {
                    binary.BigEndian.PutUint32(out[i*4:(i+1)*4], uint32(arr[i]))
                }
                return out
            }
        }
    }

    fixture s100 {
        hex: @file("fixtures/sort/sort_100.hex")
    }

    fixture s200 {
        hex: @file("fixtures/sort/sort_200.hex")
    }

    fixture s300 {
        hex: @file("fixtures/sort/sort_300.hex")
    }

    fixture s400 {
        hex: @file("fixtures/sort/sort_400.hex")
    }

    fixture s500 {
        hex: @file("fixtures/sort/sort_500.hex")
    }

    fixture s600 {
        hex: @file("fixtures/sort/sort_600.hex")
    }

    fixture s700 {
        hex: @file("fixtures/sort/sort_700.hex")
    }

    fixture s800 {
        hex: @file("fixtures/sort/sort_800.hex")
    }

    fixture s900 {
        hex: @file("fixtures/sort/sort_900.hex")
    }

    fixture s1000 {
        hex: @file("fixtures/sort/sort_1000.hex")
    }

    bench n100 {
        go: bubbleGo(s100)
    }

    bench n200 {
        go: bubbleGo(s200)
    }

    bench n300 {
        go: bubbleGo(s300)
    }

    bench n400 {
        go: bubbleGo(s400)
    }

    bench n500 {
        go: bubbleGo(s500)
    }

    bench n600 {
        go: bubbleGo(s600)
    }

    bench n700 {
        go: bubbleGo(s700)
    }

    bench n800 {
        go: bubbleGo(s800)
    }

    bench n900 {
        go: bubbleGo(s900)
    }

    bench n1000 {
        go: bubbleGo(s1000)
    }

}
